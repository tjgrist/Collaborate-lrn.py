@model Collaborate_lrn_Py.Models.Quiz

@{
    ViewBag.Title = Model.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div>
    <h4>@ViewBag.Title</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Goal)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Goal)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Instruction)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Instruction)
        </dd>
    </dl>
        <kbd id="Answer">@Html.DisplayFor(model => model.Answer)</kbd>
    <script>
        $(document).ready(function () {
            $('#Answer').hide();
            $('#answerbtn').click(function () {
                $('#Answer').fadeIn();
            });
        });
       
    </script>
    <script>
        function outf(text) {
            var mypre = document.getElementById("output");
            mypre.innerHTML = mypre.innerHTML + text;
        }
        function builtinRead(x) {
            if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
                throw "File not found: '" + x + "'";
            return Sk.builtinFiles["files"][x];
        }

        function runit() {
            var prog = document.getElementById("yourcode").value;
            var mypre = document.getElementById("output");
            isCorrect(prog, mypre);
            mypre.innerHTML = '';
            Sk.pre = "output";
            Sk.configure({ output: outf, read: builtinRead });
            (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = 'mycanvas';
            var myPromise = Sk.misceval.asyncToPromise(function () {
                return Sk.importMainWithBody("<stdin>", false, prog, true);
            });
            myPromise.then(function (mod) {
                console.log('success');
            },
                function (err) {
                    console.log(err.toString());
                });
        }
        function isCorrect(prog, outp) {
            console.log(outp);
            var stprog = prog.replace(/'/g, '');
            console.log(stprog);
            var correctOutput = "@Model.ExpectedOutput";
            if (stprog === correctOutput) {
                console.log("correct!")
                return true;
            }
            else {
                console.log("hm...")
                return false;
            }
        }
        function checkCode() {
            var output = document.getElementById("output").innerHTML.replace(" ", "");
            console.log(output);
            console.log(output);
            var correctOutput = '@Model.ExpectedOutput';
            console.log("+ " + correctOutput.replace(" ", ""));
            if (output == correctOutput.replace(" ", "")) {
                console.log("Correct output.")
                $("#result").html("That's right!").css("color", "green");
            }
            else if ($("#output").html() == correctOutput) {
                console.log("That's right!");
            }
            else {
                console.log("Not the right output.")
                $("#result").html("That's incorrect.").css("color", "red");
            }
        }
    </script>
    <h3>Try It:</h3>
    <p>Remember to use four spaces instead of tabs when indenting.</p>
    <form>
        <textarea id="yourcode" cols="80" rows="10">Write your code here.</textarea>
        <br />
        <button type="button" onclick="runit()">Run</button>
        <button type="button" onclick="checkCode()">Check</button>
        <button type="button" id="answerbtn">Show Answer</button>
        <button type="button">Rate</button>
    </form>
    <pre id="output"></pre>
    <!-- If you want turtle graphics include a canvas -->
    <div id="mycanvas"></div>
</div>
@*<script src="~/Scripts/browserpy.js" type="text/javascript"></script>*@
<div id="formSection">
    @*<h4>@ViewBag.Message</h4>
    @using (Ajax.BeginForm(
                    "Grade",
                    new AjaxOptions
                    {
                        UpdateTargetId = "result",
                        InsertionMode = InsertionMode.Replace,
                        HttpMethod = "post"
                    }))
    {
         <input type = "submit"/>
    }*@
</div>
         <div id = "result"> How'd you do?</div>

<p>
    @Html.ActionLink("Back to List", "Index")
</p>
@section scripts{
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/Scripts/react/react.min.js"></script>
    @*<script src="@Url.Content("~/Scripts/JSX/GoodJob.jsx")"></script>*@
}